<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>–ö–æ—Ç–ë–∞–Ω–∫ WORLD ‚Äî –æ–±—â–∏–π –±–∞–Ω–∫ —Å —Ä–µ–∂–∏–º–∞–º–∏</title>
<style>
  body { font-family: 'Segoe UI', Arial, sans-serif; margin:0; background: linear-gradient(120deg,#eef2ff,#f9fafb); }
  header { background: linear-gradient(90deg,#22c55e,#3b82f6); color: #fff; padding: 18px; text-align: center; font-size: 22px; font-weight: 700; }
  .container { padding: 16px; max-width: 1100px; margin: 0 auto; }
  .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
  .box { background: #fff; border-radius: 16px; padding: 16px; box-shadow: 0 8px 20px rgba(0,0,0,0.08); }
  input, select { width: 100%; padding: 10px; margin-bottom: 10px; border-radius: 10px; border: 1px solid #ddd; }
  button { padding: 10px 12px; border: none; border-radius: 12px; background: #3b82f6; color: #fff; cursor: pointer; }
  button.warn { background: #ef4444; }
  .card, .main-card { border: 2px dashed #3b82f6; border-radius: 14px; padding: 12px; margin-bottom: 12px; position: relative; }
  .money { font-weight: 700; }
  .avatar { width: 40px; height: 40px; border-radius: 50%; position: absolute; top: 10px; right: 10px; }
  .badge { background: rgba(255,255,255,.25); padding: 4px 10px; border-radius: 999px; display: inline-block; font-size: 12px; }
  .row { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 8px; }
  .hidden { display: none; }
  @media(max-width:800px){ .grid { grid-template-columns: 1fr; } }
</style>
</head>
<body>
<header>üåç –ö–æ—Ç–ë–∞–Ω–∫ WORLD</header>
<div class="container">
  <div class="box">
    <h3>–ì–ª–∞–≤–Ω–∞—è –∫–∞—Ä—Ç–∞</h3>
    <div class="main-card" id="mainCard">
      <div class="badge">–í–ª–∞–¥–µ–ª–µ—Ü</div>
      <div id="mainOwner">–°—É–ø–µ—Ä –ö–æ—Ç üòé</div>
      <div>–ù–æ–º–µ—Ä: <span id="mainNum">0000 1111 2222 3333</span></div>
      <div>–ë–∞–ª–∞–Ω—Å: <span id="mainBalance">500</span> ‚ÇΩ</div>
      <img id="mainAvatar" class="avatar" src="https://i.imgur.com/4AiXzf8.png" alt="avatar">
      <div class="row">
        <button onclick="changeBalance('main',10)">+10 ‚ÇΩ</button>
        <button onclick="changeBalance('main',50)">+50 ‚ÇΩ</button>
        <button onclick="changeBalance('main',100)">+100 ‚ÇΩ</button>
      </div>
    </div>
  </div>

  <div class="box">
    <h3>–†–µ–∂–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
    <select id="modeSelect" onchange="switchMode()">
      <option value="guest">–ì–æ—Å—Ç—å</option>
      <option value="owner">–í–ª–∞–¥–µ–ª–µ—Ü</option>
    </select>
  </div>

  <div class="grid">
    <div class="box">
      <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç—É –∫–ª–∏–µ–Ω—Ç–∞</h3>
      <input id="name" placeholder="–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞">
      <input id="shop" placeholder="–ú–∞–≥–∞–∑–∏–Ω">
      <input id="discount" placeholder="–°–∫–∏–¥–∫–∞ %" type="number">
      <button id="addCardBtn" onclick="addCard()">–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç—É</button>
    </div>
    <div class="box">
      <h3>üí≥ –í—Å–µ –∫–∞—Ä—Ç—ã –∫–ª–∏–µ–Ω—Ç–æ–≤</h3>
      <div id="cards"></div>
    </div>
  </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyA9X-bRHmAgMcGqul2M06kRQzRj7AgVWr8",
  authDomain: "bank-61db9.firebaseapp.com",
  databaseURL: "https://bank-61db9-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "bank-61db9",
  storageBucket: "bank-61db9.firebasestorage.app",
  messagingSenderId: "298674400316",
  appId: "1:298674400316:web:a615d5ee635be2d9dba739",
  measurementId: "G-HGNDB3NHTY"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const cardsRef = db.ref('cards');
const mainRef = db.ref('mainCard');
const cardsEl = document.getElementById('cards');
let mode = 'guest';

function switchMode(){
  mode = document.getElementById('modeSelect').value;
  document.getElementById('addCardBtn').style.display = mode==='owner'?'inline-block':'none';
}

function renderCard(id,data){
  const div = document.createElement('div');
  div.className='card';
  div.innerHTML=`<strong>${data.name}</strong><br>
    –ú–∞–≥–∞–∑–∏–Ω: ${data.shop}<br>
    –°–∫–∏–¥–∫–∞: ${data.discount}%<br>
    –ë–∞–ª–∞–Ω—Å: <span class="money">${data.balance}</span> ‚ÇΩ<br>
    <div class="row">
      <button onclick="changeBalance('${id}',10)">+10</button>
      <button onclick="changeBalance('${id}',-10)">-10</button>
      ${mode==='owner'?'<button class="warn" onclick="removeCard(\''+id+'\')">–£–¥–∞–ª–∏—Ç—å</button>':''}
    </div>`;
  return div;
}

function loadCards(){
  cardsRef.on('value',snap=>{
    cardsEl.innerHTML='';
    snap.forEach(c=>{
      cardsEl.appendChild(renderCard(c.key,c.val()));
    });
  });
  mainRef.on('value',snap=>{
    const data = snap.val();
    if(!data) return;
    document.getElementById('mainOwner').textContent = data.owner;
    document.getElementById('mainNum').textContent = data.num;
    document.getElementById('mainBalance').textContent = data.balance;
    document.getElementById('mainAvatar').src = data.avatar;
  });
}

function addCard(){
  const name=document.getElementById('name').value;
  const shop=document.getElementById('shop').value;
  const discount=document.getElementById('discount').value;
  if(!name||!shop||!discount){alert('–ó–∞–ø–æ–ª–Ω–∏ –≤—Å–µ –ø–æ–ª—è'); return;}
  cardsRef.push({name,shop,discount,balance:0});
  document.getElementById('name').value='';
  document.getElementById('shop').value='';
  document.getElementById('discount').value='';
}

function changeBalance(id,amt){
  if(id==='main'){
    mainRef.once('value',s=>{
      const b = s.val()?.balance || 0;
      mainRef.update({balance: b+amt});
    });
  } else {
    cardsRef.child(id).once('value',s=>{
      const b = s.val()?.balance || 0;
      const newBal = b+amt<0?0:b+amt;
      cardsRef.child(id).update({balance:newBal});
    });
  }
}

function removeCard(id){ if(confirm('–£–¥–∞–ª–∏—Ç—å –∫–∞—Ä—Ç—É?')) cardsRef.child(id).remove(); }

switchMode();
loadCards();
</script>
</body>
</html>
